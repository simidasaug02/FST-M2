apiVersion: v1
kind: Deployment
metadata:
  name: postgres-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
        component: postgres
  template:
     metadata:
         labels:
             component: postgres
     spec: 
       volumes:
         - name: postgres-storage
           PersistentVolumeClaim:
             claimName: postgres-persistent-volume-claim
       containers:
           - name: postgres
             image: postgres
             ports:
               - containerPort: 5432
                 limits:
                     memory: "128Mi"
                     cpu: "500m"
             volumeMounts:
                   - name: postgres-storage
                     mountPath: /var/lib/postgres/data
             env:
               - name: POSTGRES_PASSWORD
                 valueFrom:
                 secretKeyRef:
                     name: pgpassword
                     key: POSTGRES_PASSWORD
               - name: POSTGRES_DB
                 value: simple_blog_api    
 